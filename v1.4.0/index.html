<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Facturanza v1.4.0 - Novedades</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #F5F5F5;
            --bg-secondary: #FFFFFF;
            --text-primary: #414141;
            --text-secondary: #6F6F6F;
            --brand-primary: #5EB0C7;
            --brand-secondary: #005973;
            --brand-light-green: #63D389;
            --cta-text-color: #005973; /* Consistent blue for CTA buttons */
            --logo-filter: none;
        }

        .dark {
            --bg-primary: #2d3748;
            --bg-secondary: #4a5568;
            --text-primary: #E8E8E8;
            --text-secondary: #A0AEC0;
            --brand-primary: #5EB0C7;
            --brand-secondary: #A4D2DF;
            --brand-light-green: #63D389;
            --logo-filter: none;
        }
        
        html {
            scroll-behavior: smooth;
        }

        body {
            background-color: var(--bg-primary);
            color: var(--text-primary);
            font-family: 'Inter', sans-serif;
            transition: background-color 0.3s ease, color 0.3s ease;
        }

        .card {
            background-color: var(--bg-secondary);
            transition: background-color 0.3s ease;
        }
        .text-main { color: var(--text-primary); }
        .text-subtle { color: var(--text-secondary); }
        .brand-logo {
             filter: var(--logo-filter);
             transition: filter 0.3s ease;
        }
        
        .title-color {
            color: var(--brand-secondary);
        }
        .dark .title-color {
            color: var(--text-primary);
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .fade-in {
            animation: fadeIn 0.5s ease-out forwards;
        }

        /* Sticky Nav Styles */
        .top-nav {
            background-color: var(--bg-secondary);
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .dark .top-nav {
            box-shadow: 0 2px 4px rgba(0,0,0,0.4);
        }
        .nav-link {
            color: var(--text-secondary);
            border-bottom: 2px solid transparent;
        }
        .nav-link.active {
            color: var(--brand-primary);
            border-bottom-color: var(--brand-primary);
            font-weight: 600;
        }
        
        /* CTA Button Styles */
        .cta-button {
            background-color: var(--brand-light-green);
            color: var(--cta-text-color);
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        .cta-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
        .cta-button svg {
            color: var(--cta-text-color);
        }

        /* Hide scrollbar for the nav */
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .no-scrollbar {
            -ms-overflow-style: none;  /* IE and Edge */
            scrollbar-width: none;  /* Firefox */
        }
    </style>
</head>
<body class="antialiased">

    <!-- Main Container -->
    <div class="container mx-auto p-4 md:p-8">

        <!-- Header -->
        <header class="flex justify-between items-center mb-8">
            <img src="https://firebasestorage.googleapis.com/v0/b/facturanza-cr-public/o/logo_horizontal.png?alt=media&token=f4c8a97c-6c11-4c51-a164-4020c0ea131c" alt="Facturanza Logo" class="h-10 brand-logo">
            <!-- Dark Mode Toggle -->
            <div class="flex items-center space-x-2">
                 <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-subtle" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path></svg>
                <button id="theme-toggle" class="relative inline-flex items-center h-6 rounded-full w-11 transition-colors bg-gray-300 dark:bg-brand-secondary">
                    <span id="theme-toggle-indicator" class="inline-block w-4 h-4 transform bg-white rounded-full transition-transform duration-300 ease-in-out"></span>
                </button>
                 <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-subtle" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path></svg>
            </div>
        </header>
    </div>

    <!-- Sticky Top Navigation -->
    <nav id="top-nav-bar" class="top-nav sticky top-0 z-20">
        <div id="nav-container" class="container mx-auto px-4 overflow-x-auto no-scrollbar">
            <div id="nav-links" class="flex space-x-6 whitespace-nowrap py-3">
                <!-- Nav links will be injected here by JavaScript -->
            </div>
        </div>
    </nav>

    <!-- Main content area -->
    <main id="feature-content" class="container mx-auto p-4 md:p-8">
        <!-- All feature sections will be rendered here -->
    </main>
    
    <!-- Footer -->
    <footer class="text-center my-12 text-subtle">
        <p>&copy; 2025 Facturanza. Gracias por tu valiosa contribución.</p>
        <a href="https://roadmap.facturanza.com" target="_blank" rel="noopener noreferrer" class="text-sm text-subtle hover:text-[var(--brand-primary)] underline transition-colors">
            Ver Roadmap
        </a>
    </footer>

    <script>
        // --- UTILITY FUNCTIONS ---
        function slugify(text) {
            const a = 'àáâäæãåāăąçćčđďèéêëēėęěğǵḧîïíīįìłḿñńǹňôöòóœøōõőṕŕřßśšşșťțûüùúūǘůűųẃẍÿýžźż·/_,:;'
            const b = 'aaaaaaaaaacccddeeeeeeeegghiiiiiilmnnnnoooooooooprrsssssttuuuuuuuuuwxyyzzz------'
            const p = new RegExp(a.split('').join('|'), 'g')

            return text.toString().toLowerCase()
                .replace(/\s+/g, '-') // Replace spaces with -
                .replace(p, c => b.charAt(a.indexOf(c))) // Replace special characters
                .replace(/&/g, '-and-') // Replace & with 'and'
                .replace(/[^\w\-]+/g, '') // Remove all non-word chars
                .replace(/\-\-+/g, '-') // Replace multiple - with single -
                .replace(/^-+/, '') // Trim - from start of text
                .replace(/-+$/, '') // Trim - from end of text
        }

        // --- DATA ---
        const featuresData = [
            {
                category: "General",
                items: [
                    { title: "Mejoras estéticas", description: "Se reconstruyó el diseño de diversos componentes y páginas para una experiencia de usuario más moderna e intuitiva.", images: [ "https://firebasestorage.googleapis.com/v0/b/facturanza-cr-public/o/v1.4.0%2Fgraficos.png?alt=media&token=675ea69e-5258-452a-a48f-d7cd588126ad", "https://firebasestorage.googleapis.com/v0/b/facturanza-cr-public/o/v1.4.0%2Fclientes.png?alt=media&token=9e81abbe-7e55-41f5-9078-167130b87855", "https://firebasestorage.googleapis.com/v0/b/facturanza-cr-public/o/v1.4.0%2Freenviar_correo.png?alt=media&token=c01619fc-62a9-4a43-a099-012e17cfcbda", "https://firebasestorage.googleapis.com/v0/b/facturanza-cr-public/o/v1.4.0%2Fproductos.png?alt=media&token=478195bc-ecf1-44b5-9acb-4f2c4a2d0874" ] },
                    { title: "Visualización de estadísticas", description: "Se han incluido gráficos para la representación de ingresos y egresos de la empresa, permitiendo un análisis financiero más claro y directo.", image: "https://firebasestorage.googleapis.com/v0/b/facturanza-cr-public/o/v1.4.0%2Fgraficos.png?alt=media&token=675ea69e-5258-452a-a48f-d7cd588126ad" },
                    { title: "Indicador de facturación activa", description: "Se implementó una etiqueta para indicar cuándo los datos de facturación están completos y la facturación está activa, brindando mayor claridad sobre el estado de la cuenta.", image: "https://firebasestorage.googleapis.com/v0/b/facturanza-cr-public/o/v1.4.0%2Ffacturacion_habilitada.png?alt=media&token=e0820db5-ff5f-4f6c-b2b2-1079b375bd61" },
                ],
            },
            {
                category: "Inteligencia Artificial",
                items: [
                    { title: "Creación de productos automatizados", description: "Se ha integrado inteligencia artificial para facilitar la creación de productos, completando automáticamente la información a partir de una simple descripción.", image: "https://firebasestorage.googleapis.com/v0/b/facturanza-cr-public/o/v1.4.0%2Fgenerar_producto.png?alt=media&token=021caa35-7c03-4188-9e83-31e5e8df9046" },
                    { title: "Explicación de rechazo de facturas", description: "Se ha implementado una función de IA para facilitar al usuario la comprensión del motivo de rechazo de una factura, traduciendo los códigos de error en explicaciones claras.", image: "https://firebasestorage.googleapis.com/v0/b/facturanza-cr-public/o/v1.4.0%2Fexplicar_error.png?alt=media&token=bcab6efe-e01e-4a42-87d8-e15a3ee18b7d" },
                ],
            },
            {
                category: "Facturación",
                items: [
                    { title: "Códigos de exoneración", description: "Se ha incluido la opción para aplicar un código de exoneración por producto al momento de crear la factura, simplificando el manejo de impuestos especiales.", image: "https://firebasestorage.googleapis.com/v0/b/facturanza-cr-public/o/v1.4.0%2Fexoneracion.png?alt=media&token=464354ff-e554-440a-a7a4-dd2a19fcbf0b" },
                    { title: "Reenvío de facturas por correo", description: "Se implementó la opción para reenviar una factura a múltiples direcciones de correo electrónico de forma sencilla.", image: "https://firebasestorage.googleapis.com/v0/b/facturanza-cr-public/o/v1.4.0%2Freenviar_correo.png?alt=media&token=c01619fc-62a9-4a43-a099-012e17cfcbda" },
                    { title: "Notas y comentarios en facturas", description: "Se incluyó un espacio dedicado para añadir notas y comentarios a una factura, mejorando la comunicación y el registro de información adicional.", image: "https://firebasestorage.googleapis.com/v0/b/facturanza-cr-public/o/v1.4.0%2Fnotas.png?alt=media&token=4c67cc45-a0e8-49cd-9600-6798826d6489" },
                    { title: "Visualización por lapsos de tiempo", description: "Se agregó un selector de fecha para visualizar la lista de facturas, permitiendo filtrar por rangos específicos. El periodo predeterminado es el mes actual.", images: ["https://firebasestorage.googleapis.com/v0/b/facturanza-cr-public/o/v1.4.0%2Fselector_fecha.png?alt=media&token=f98a7394-77a8-4ec2-b49c-664a4d9fbaee", "https://firebasestorage.googleapis.com/v0/b/facturanza-cr-public/o/v1.4.0%2Fcalendar.png?alt=media&token=51632303-0d73-44ee-a516-51c99980b2c9"] },
                    { title: "Inclusión de facturas de egresos", 
                    description: "Se añadió la función para subir los archivos .xml de las facturas de compra (egresos), con el objetivo de poder visualizar datos comparativos y tener un control financiero completo.", 
                    images: ["https://firebasestorage.googleapis.com/v0/b/facturanza-cr-public/o/v1.4.0%2Fsubir_compra.png?alt=media&token=2ec24d3d-515e-4f35-97c5-ab95847456ca"
                    ,"https://firebasestorage.googleapis.com/v0/b/facturanza-cr-public/o/v1.4.0%2Fsubir_compras.png?alt=media&token=d9c351eb-b9e4-468c-a06c-603f4c15c2eb"] },
                ],
            },
            {
                category: "Nuevas Implementaciones",
                items: [
                    { title: "Gestión de sucursales y terminales", description: "Esta nueva funcionalidad permite a una empresa administrar y facturar desde diferentes sucursales, así como desde múltiples terminales dentro de una misma sucursal.", image: "https://firebasestorage.googleapis.com/v0/b/facturanza-cr-public/o/v1.4.0%2Fsucursales.png?alt=media&token=0df9bb7e-88d3-4f63-9862-4ba97b6663a0" },
                    { title: "Pagos manuales de membresías", description: "Se ha implementado la funcionalidad para facilitar los pagos manuales (transferencia o Sinpe Móvil) de membresías y compra de paquetes de facturas.", image: "https://firebasestorage.googleapis.com/v0/b/facturanza-cr-public/o/v1.4.0%2Fpago_manual.png?alt=media&token=bcc89247-a2e5-4a08-8013-d1f59ff8ea11" },
                ],
            },
        ].map(category => ({
            ...category,
            id: slugify(category.category),
            items: category.items.map(item => ({
                ...item,
                id: `${slugify(category.category)}.${slugify(item.title)}`
            }))
        }));

        // --- DOM Elements ---
        const navLinksContainer = document.getElementById('nav-links');
        const featureContent = document.getElementById('feature-content');
        const themeToggle = document.getElementById('theme-toggle');
        const themeToggleIndicator = document.getElementById('theme-toggle-indicator');
        const body = document.body;

        // --- Functions ---
        
        function renderPage() {
            let navHTML = '';
            let contentHTML = '';

            const welcomeId = 'bienvenido';
            navHTML += `<a href="#${welcomeId}" class="nav-link transition-all duration-200 py-1" data-target="${welcomeId}">Bienvenido</a>`;
            contentHTML += `
                <section id="${welcomeId}" class="scroll-mt-24 page-section text-center min-h-[40vh] flex flex-col justify-center items-center py-6">
                    <img src="https://firebasestorage.googleapis.com/v0/b/facturanza-cr-public/o/logo_horizontal.png?alt=media&token=f4c8a97c-6c11-4c51-a164-4020c0ea131c" alt="Facturanza Logo" class="h-16 brand-logo mb-6">
                    <h2 class="title-color text-4xl font-bold mb-2">¡Bienvenido a la nueva versión de Facturanza!</h2>
                    <p class="text-2xl font-semibold text-[var(--brand-primary)] mb-4">versión 1.4.0</p>
                    <p class="text-xl text-subtle max-w-2xl mb-8">Hemos trabajado en nuevas funciones y mejoras para potenciar tu negocio. Navega para ver los detalles.</p>
                    <a href="https://app.facturanza.com" target="_blank" rel="noopener noreferrer" class="cta-button inline-flex items-center gap-2 font-bold py-3 px-6 rounded-xl">
                        <span>Ir al facturador</span>
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10.293 3.293a1 1 0 011.414 0l6 6a1 1 0 010 1.414l-6 6a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-4.293-4.293a1 1 0 010-1.414z" clip-rule="evenodd" /></svg>
                    </a>
                </section>
            `;

            featuresData.forEach((category, categoryIndex) => {
                navHTML += `<a href="#${category.id}" class="nav-link transition-all duration-200 py-1" data-target="${category.id}">${category.category}</a>`;
                
                contentHTML += `
                    <section id="${category.id}" class="page-section scroll-mt-24 text-center pt-16 pb-8">
                        <h2 class="text-5xl font-bold title-color">${category.category}</h2>
                    </section>
                `;

                category.items.forEach(item => {
                    let imagesHTML = '';
                    if (item.images && item.images.length > 0) {
                        imagesHTML = `<div class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-6">`;
                        item.images.forEach(imgUrl => {
                            imagesHTML += `<img src="${imgUrl}" alt="${item.title}" class="w-full rounded-xl shadow-lg border-4 border-[var(--bg-secondary)]" onerror="this.onerror=null;this.src='https://placehold.co/600x400/cccccc/ffffff?text=Imagen+no+disponible';">`;
                        });
                        imagesHTML += `</div>`;
                    } else if (item.image) {
                        imagesHTML = `<img src="${item.image}" alt="${item.title}" class="w-full rounded-xl shadow-2xl border-4 border-[var(--bg-secondary)] mt-6" onerror="this.onerror=null;this.src='https://placehold.co/800x500/cccccc/ffffff?text=Imagen+no+disponible';">`;
                    }

                    contentHTML += `
                        <section id="${item.id}" class="page-section card rounded-2xl p-8 mb-8 scroll-mt-24">
                            <h3 class="title-color text-3xl md:text-4xl font-bold mb-4">${item.title}</h3>
                            <p class="text-lg text-subtle">${item.description}</p>
                            ${imagesHTML}
                        </section>
                    `;
                });

                // Add CTAs after the last item of the last category
                if (categoryIndex === featuresData.length - 1) {
                    contentHTML += `
                        <section class="text-center py-12">
                            <h3 class="text-3xl font-bold text-main mb-6">¿Listo para empezar?</h3>
                            <div class="flex flex-col sm:flex-row justify-center items-center gap-4">
                                <a href="https://facturanza.com" target="_blank" rel="noopener noreferrer" class="cta-button inline-flex items-center gap-2 font-bold py-3 px-6 rounded-xl w-full sm:w-auto">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 00-1.414 1.414 4 4 0 005.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 00-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" /></svg>
                                    <span>Visitar sitio web</span>
                                </a>
                                <a href="https://app.facturanza.com" target="_blank" rel="noopener noreferrer" class="cta-button inline-flex items-center gap-2 font-bold py-3 px-6 rounded-xl w-full sm:w-auto">
                                    <span>Ir al facturador</span>
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10.293 3.293a1 1 0 011.414 0l6 6a1 1 0 010 1.414l-6 6a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-4.293-4.293a1 1 0 010-1.414z" clip-rule="evenodd" /></svg>
                                </a>
                            </div>
                        </section>
                    `;
                }
            });

            navLinksContainer.innerHTML = navHTML;
            featureContent.innerHTML = contentHTML;
        }

        function toggleTheme() {
            body.classList.toggle('dark');
            const isDarkMode = body.classList.contains('dark');
            localStorage.setItem('theme', isDarkMode ? 'dark' : 'light');
            updateToggleIndicator(isDarkMode);
        }

        function updateToggleIndicator(isDarkMode) {
            themeToggleIndicator.classList.toggle('translate-x-5', isDarkMode);
            themeToggleIndicator.classList.toggle('translate-x-1', !isDarkMode);
        }

        function initializeTheme() {
            const useDarkMode = localStorage.getItem('theme') === 'dark' ||
                (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches);
            
            if (useDarkMode) body.classList.add('dark');
            updateToggleIndicator(useDarkMode);
        }

        function setupScrollspy() {
            const sections = document.querySelectorAll('.page-section');
            const navLinks = document.querySelectorAll('.nav-link');
            
            const observer = new IntersectionObserver(entries => {
                let bestEntry = null;
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                       if (!bestEntry || entry.intersectionRatio > bestEntry.intersectionRatio) {
                           bestEntry = entry;
                       }
                    }
                });

                if (bestEntry) {
                    const fullId = bestEntry.target.getAttribute('id');
                    const categoryId = fullId.includes('.') ? fullId.split('.')[0] : fullId;
                    const activeNavLink = document.querySelector(`.nav-link[data-target='${categoryId}']`);

                    if (activeNavLink) {
                         navLinks.forEach(link => link.classList.remove('active'));
                         activeNavLink.classList.add('active');
                    }
                     history.replaceState(null, null, `#${fullId}`);
                }
            }, { 
                threshold: 0.1,
                rootMargin: "-88px 0px -50% 0px"
            }); 

            sections.forEach(section => observer.observe(section));
        }

        document.addEventListener('DOMContentLoaded', () => {
            initializeTheme();
            renderPage();
            setupScrollspy();

            if (window.location.hash) {
                const targetId = window.location.hash.substring(1);
                const targetElement = document.getElementById(targetId);
                if (targetElement) {
                    setTimeout(() => {
                        targetElement.scrollIntoView({ behavior: 'auto' });
                    }, 100);
                }
            }
        });

        themeToggle.addEventListener('click', toggleTheme);
    </script>

</body>
</html>
